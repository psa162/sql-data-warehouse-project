/* 
======================================================================================
QUALITY CHECKS
======================================================================================
Script purpose:
This script performs various quality checks for data consitency, accuracy and standardisation. 
It includes:
- Check for duplicates
-Unwanted spaces in strings field
-Invalid dates ranges
- Data consistency between related fields.

Usage Notes:
- Run these checks after loading gold Layer
-Investigate and resolve any discrepancies found during the checks

============================================================================================
*/
--- Check for duplicates, conflicting data
SELECT DISTINCT
ci.cst_gndr,
ca.gen,
CASE WHEN ci.cst_gndr !='n/a' THEN ci.cst_gndr --- CRM is the Master for the gender Info 
ELSE COALESCE(ca.gen, 'n/a')
END AS new_gen
FROM silver.crm_cust_info ci
LEFT JOIN silver.erp_cust_az12 ca
ON ci.cst_key = ca.cid
LEFT JOIN silver.erp_loc_a101 la
ON ci.cst_key = la.cid
ORDER BY 1,2
